(this.webpackJsonpjeopardy_frontend=this.webpackJsonpjeopardy_frontend||[]).push([[0],{100:function(e,t,n){},111:function(e,t,n){},242:function(e,t,n){},243:function(e,t,n){},244:function(e,t,n){"use strict";n.r(t);var r=n(0),s=n(1),a=n.n(s),i=n(38),c=n.n(i),o=(n(111),n(8)),u=n(7),d=n(34),l=n(17),m=n(32),b=function(e){var t=e.label,n=Object(m.a)(e,["label"]),s=Object(o.d)(n),a=Object(l.a)(s,2),i=a[0],c=a[1];return Object(r.jsxs)("div",{className:"form-group",children:[Object(r.jsxs)("label",{htmlFor:n.name,children:[" ",t," "]}),Object(r.jsx)("input",Object(d.a)(Object(d.a)({className:"text-input"},i),n)),Object(r.jsxs)("div",{className:"error",style:{visibility:c.touched&&c.error?"visible":"hidden"},children:[c.error||"no error"," "]})]})},j=function(e){var t=Object(o.d)(e),n=Object(l.a)(t,2)[1];return Object(r.jsx)("div",{className:"form-group",children:Object(r.jsxs)("div",{className:"error",style:{visibility:n.error?"visible":"hidden"},children:[n.error||"no error"," "]})})},O=n(10),h=n(5),f=n(6),x=n(13),g=n.n(x),p="http://127.0.0.1:8000/static";g.a.defaults.baseURL="http://127.0.0.1:8000/api",g.a.interceptors.request.use((function(e){if("/sessions/"!==e.url){var t=localStorage.getItem("access_token");e.headers.Authorization="Bearer ".concat(t)}return e})),g.a.interceptors.response.use((function(e){return e}),(function(e){var t;if(401!==e.response.status||"/sessions/"===e.config.url)return console.log(e),Promise.reject(e);if("access"!==(null===(t=e.response.data.messages)||void 0===t?void 0:t[0].token_type))return localStorage.clear(),Promise.reject(e);var n=localStorage.getItem("refresh_token");if(n)return g.a.post("/sessions/new_token/",{refresh:n}).then((function(e){localStorage.setItem("access_token",e.data.access)})).catch((function(e){console.log(e)})),g.a.request(e.config);console.log(e.response)}));var v=function(){function e(){Object(h.a)(this,e)}return Object(f.a)(e,[{key:"register",value:function(e){return g.a.post("/users/",{username:e.username,nickname:e.nickname,password:e.password}).then((function(e){return localStorage.setItem("access_token",e.data.access),localStorage.setItem("refresh_token",e.data.refresh),e.status})).catch((function(e){return e.response.status}))}},{key:"login",value:function(e){return g.a.post("/sessions/",{username:e.username,password:e.password}).then((function(e){return localStorage.setItem("access_token",e.data.access),localStorage.setItem("refresh_token",e.data.refresh),e.status})).catch((function(e){return e.response.status}))}}]),e}(),y=function(){function e(){Object(h.a)(this,e)}return Object(f.a)(e,[{key:"getDescriptions",value:function(){return g.a.get("/games/")}}]),e}(),S=function(){function e(){Object(h.a)(this,e)}return Object(f.a)(e,[{key:"getDescriptions",value:function(){return g.a.get("/game_sessions/")}}]),e}(),_=function(){function e(){Object(h.a)(this,e)}return Object(f.a)(e,[{key:"post",value:function(e){return g.a.post("/games/",e).catch((function(e){if(409===e.response.status)return Promise.reject(new Error("\u0418\u0433\u0440\u0430 \u0441 \u0442\u0430\u043a\u0438\u043c \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435\u043c \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442"))}))}}]),e}(),w=function(){function e(){Object(h.a)(this,e)}return Object(f.a)(e,[{key:"get",value:function(e){var t="/users/".concat(e,"/");return g.a.get(t)}},{key:"save",value:function(e,t,n){var r="/users/".concat(e,"/"),s={};return t&&t.length>0&&(s.nickname=t),n&&n.length>0&&(s.password=n),g.a.patch(r,s)}}]),e}(),N=function(){function e(){Object(h.a)(this,e)}return Object(f.a)(e,[{key:"create",value:function(e,t){return console.log("create"),g.a.post("/game_sessions/",{game_name:e,max_players:t})}},{key:"join",value:function(e){var t="game_sessions/chosen/".concat(e,"/");return g.a.post(t)}},{key:"leave",value:function(e){var t="game_sessions/exited/".concat(e,"/");g.a.delete(t)}},{key:"choose_question",value:function(e,t,n){var r="game_sessions/".concat(e,"/question/");g.a.post(r,{theme_order:t,question_order:n}).catch((function(e){return console.log(e)}))}},{key:"submit_answer",value:function(e,t){var n="game_sessions/".concat(e,"/answer/");g.a.post(n,{answer:t})}},{key:"get_host_image_url",value:function(e){var t=p+"/img/kuleshov/"+e+".jpg";return console.log(t),t}},{key:"get_avatar_url",value:function(){var e=p+"/img/avatar.png";return console.log(e),e}}]),e}(),A=Object(s.createContext)({}),k=new v;function E(){return Object(s.useContext)(A)}function R(e){var t=e.children,n=function(){function e(e){localStorage.setItem("username",e)}return{register:function(t){return k.register(t).then((function(n){if(!(n<400)){var r;switch(n){case 409:r="\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442";break;case 401:r="\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435";break;default:r="\u041e\u0448\u0438\u0431\u043a\u0430"}return Promise.reject(new Error(r))}e(t.username)}))},login:function(t){return k.login(t).then((function(n){if(!(n<400)){var r;switch(n){case 401:r="\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435";break;default:r="\u041e\u0448\u0438\u0431\u043a\u0430"}return Promise.reject(new Error(r))}e(t.username)}))},isAuthenticated:function(){return null!==localStorage.getItem("access_token")},getUsername:function(){return localStorage.getItem("username")}}}();return Object(r.jsx)(A.Provider,{value:n,children:t})}function C(e){var t=e.children,n=Object(m.a)(e,["children"]),s=E();return Object(r.jsx)(O.b,Object(d.a)(Object(d.a)({},n),{},{render:function(e){var n=e.location;return s.isAuthenticated()?t:Object(r.jsx)(O.a,{to:{pathname:"/login",state:{from:n}}})}}))}var I=n(14),F=function(){var e=E(),t=Object(O.g)();return document.title="\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",Object(r.jsx)("div",{className:"form",children:Object(r.jsx)(o.c,{initialValues:{username:"",nickname:"",password:""},validationSchema:u.b({username:u.c().min(2,"\u041d\u0435 \u043c\u0435\u043d\u0435\u0435 2 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432").max(25,"\u041d\u0435 \u0431\u043e\u043b\u0435\u0435 25 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432").required("\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435"),nickname:u.c().min(2,"\u041d\u0435 \u043c\u0435\u043d\u0435\u0435 2 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432").max(25,"\u041d\u0435 \u0431\u043e\u043b\u0435\u0435 25 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"),password:u.c().min(6,"\u041d\u0435 \u043c\u0435\u043d\u0435\u0435 6 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432").max(128,"\u041d\u0435 \u0431\u043e\u043b\u0435\u0435 128 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432").required("\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435")}),onSubmit:function(n,r){var s=r.setSubmitting,a=r.setErrors;e.register(n).then((function(){console.log("\u0437\u0430\u0440\u0435\u0433\u0430\u043d"),s(!1),t.push("/games")})).catch((function(e){a({submitError:e.message})}))},children:Object(r.jsxs)(o.b,{children:[Object(r.jsx)("header",{children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(r.jsx)(b,{label:"\u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",name:"username",type:"text"}),Object(r.jsx)(b,{label:"\u041d\u0438\u043a",name:"nickname",type:"text",placeholder:"\u041d\u0435\u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e"}),Object(r.jsx)(b,{label:"\u041f\u0430\u0440\u043e\u043b\u044c",name:"password",type:"password"}),Object(r.jsx)(j,{name:"submitError"}),Object(r.jsx)(I.b,{to:"/login",children:"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?"}),Object(r.jsx)("button",{type:"submit",children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})]})})})},T=function(){var e=E(),t=Object(O.g)();return document.title="\u0412\u0445\u043e\u0434",Object(r.jsx)("div",{className:"form",children:Object(r.jsx)(o.c,{initialValues:{username:"",password:""},validationSchema:u.b({username:u.c().required("\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435"),password:u.c().required("\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435")}),onSubmit:function(n,r){var s=r.setSubmitting,a=r.setErrors;e.login(n).then((function(){s(!1),t.push("/games")})).catch((function(e){a({submitError:e.message})}))},children:Object(r.jsxs)(o.b,{children:[Object(r.jsx)("header",{children:"\u0412\u0445\u043e\u0434"}),Object(r.jsx)(b,{label:"\u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",name:"username",type:"text"}),Object(r.jsx)(b,{label:"\u041f\u0430\u0440\u043e\u043b\u044c",name:"password",type:"password"}),Object(r.jsx)(j,{name:"submitError"}),Object(r.jsx)(I.b,{to:"/register",children:"\u0415\u0449\u0435 \u043d\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?"}),Object(r.jsx)("button",{type:"submit",children:"\u0412\u043e\u0439\u0442\u0438"})]})})})},D=(n(96),n(33)),q=n.n(D),G=n(3),Q=n(9),U=n(2),P=U.b.model({id:U.b.number,creator:U.b.string,gameName:U.b.string,maxPlayers:U.b.number,currentPlayers:U.b.number}).actions((function(e){return{setPlayerJoined:function(){e.currentPlayers+=1},setPlayerLeft:function(){e.currentPlayers-=1}}})),L=U.b.model({descriptions:U.b.map(P)}).actions((function(e){return{listener:function(t,n){switch(t){case"init":e.init(n);break;case"game_session_created":e.addDescription(n.id,n.creator,n.game_name,n.max_players,n.current_players);break;case"game_session_deleted":e.deleteDescription(n.id);break;case"player_joined":e.descriptions.get(n.id).setPlayerJoined();break;case"player_left":console.log(e.descriptions),e.descriptions.get(n.id)&&e.descriptions.get(n.id).setPlayerLeft(),console.log(e.descriptions);break;default:throw new Error("\u043d\u0435\u0442 \u0442\u0430\u043a\u043e\u0433\u043e \u0441\u043e\u0431\u044b\u0442\u0438\u044f")}},initialize:function(t){t.forEach((function(t){return e.addDescription(t.id,t.creator,t.game_name,t.max_players,t.current_players)}))},addDescription:function(t,n,r,s,a){e.descriptions.set(t,P.create({id:t,creator:n,gameName:r,maxPlayers:s,currentPlayers:a}))},deleteDescription:function(t){e.descriptions.delete(t)}}})),V=U.b.model({id:U.b.identifier,name:U.b.string,author:U.b.string,roundsCount:U.b.number}),W=U.b.model({descriptions:U.b.map(V),chosenGame:U.b.maybe(U.b.reference(V))}).actions((function(e){return{set:function(t){t.forEach((function(t){e.addDescription(t.name,t.name,t.author,t.rounds_count)}))},addDescription:function(t,n,r,s){e.descriptions.set(t,V.create({id:t,name:n,author:r,roundsCount:s}))},setChosenGame:function(t){e.chosenGame=t}}})),z=U.b.model({isCreateGameSessionFormOpen:!1}).actions((function(e){return{toggleCreateGameSessionFormOpen:function(){e.isCreateGameSessionFormOpen=!e.isCreateGameSessionFormOpen}}})),H=n(20),M=Object.freeze({WAITING:"WAITING",ROUND_STARTED:"ROUND_STARTED",CHOOSING_QUESTION:"CHOOSING_QUESTION",ANSWERING:"ANSWERING",TIMEOUT:"TIMEOUT",ROUND_ENDED:"ROUND_ENDED",FINAL_ROUND_STARTED:"FINAL_ROUND_STARTED",FINAL_ROUND:"FINAL_ROUND",END_GAME:"END_GAME"});function J(e){return["\u041d\u0443\u043b\u0435\u0432\u043e\u0439","\u041f\u0435\u0440\u0432\u044b\u0439","\u0412\u0442\u043e\u0440\u043e\u0439","\u0422\u0440\u0435\u0442\u0438\u0439","\u0427\u0435\u0442\u0432\u0435\u0440\u0442\u044b\u0439","\u041f\u044f\u0442\u044b\u0439","\u0428\u0435\u0441\u0442\u043e\u0439","\u0421\u0435\u0434\u044c\u043c\u043e\u0439","\u0412\u043e\u0441\u044c\u043c\u043e\u0439","\u0414\u0435\u0432\u044f\u0442\u044b\u0439"][e]}var B=[100,200,300,400,500,600,700,800,900,1e3],K=U.b.model({id:U.b.identifier,value:U.b.number,text:U.b.maybe(U.b.string),answer:U.b.maybe(U.b.string)}).actions((function(e){return{set:function(t,n){e.text=t,e.answer=n}}})).views((function(e){return{get isSet(){return!!e.text}}})),X=U.b.model({name:U.b.string,questions:U.b.array(K)}),Y=U.b.model({id:U.b.identifier,themes:U.b.array(X),questionValues:U.b.array(U.b.number)}).actions((function(e){return{addTheme:function(t){e.themes.push(X.create({name:t,questions:e.questionValues.map((function(n){return K.create({id:e.id.toString()+t+n.toString(),value:n})}))}))}}})).views((function(e){return{get index(){return Number(e.id.slice(e.id.lastIndexOf("_")+1))}}})),Z=U.b.model({name:U.b.maybe(U.b.string),roundsCount:U.b.maybe(U.b.number),questionsCount:U.b.maybe(U.b.number),rounds:U.b.array(Y),finalRound:U.b.maybe(K),selectedRound:U.b.maybe(U.b.reference(Y)),selectedQuestion:U.b.maybe(U.b.reference(K))}).actions((function(e){return{setGameParams:function(t,n,r){e.name=t,e.roundsCount=n,e.questionsCount=r;for(var s=function(t){e.rounds[t]=Y.create({id:e.name+"_"+t.toString(),questionValues:B.slice(0,e.questionsCount).map((function(e){return e*(t+1)}))})},a=0;a<e.roundsCount-1;a++)s(a);e.finalRound=K.create({id:"final",value:200*e.roundsCount*e.questionsCount}),e.selectedRound=e.rounds[0]},setSelectedQuestion:function(t){e.selectedQuestion=t},previousRound:function(){e.selectedRound=e.rounds[e.selectedRound.index-1]},nextRound:function(){e.selectedRound=e.rounds[e.selectedRound.index+1]},setFinalRound:function(t,n){e.finalRound.set(t,n)},clear:function(){e.name=void 0,e.roundsCount=void 0,e.roundsCount=void 0,e.rounds=[],e.finalRound=void 0,e.selectedRound=void 0,e.selectedQuestion=void 0}}})).views((function(e){return{get isAllRoundsFilled(){var t,n=Object(H.a)(e.rounds);try{for(n.s();!(t=n.n()).done;){if(0===t.value.themes.length)return!1}}catch(r){n.e(r)}finally{n.f()}return!0},get isAllQuestionsFilled(){var t,n=Object(H.a)(e.rounds);try{for(n.s();!(t=n.n()).done;){var r,s=t.value,a=Object(H.a)(s.themes);try{for(a.s();!(r=a.n()).done;){var i,c=r.value,o=Object(H.a)(c.questions);try{for(o.s();!(i=o.n()).done;){if(!i.value.isSet)return!1}}catch(u){o.e(u)}finally{o.f()}}}catch(u){a.e(u)}finally{a.f()}}}catch(u){n.e(u)}finally{n.f()}return!0}}})),$=U.b.model({isAddGameFormOpen:!0,isAddThemeFormOpen:!1,isAddQuestionFormOpen:!1,isAddFinalQuestionFormOpen:!1}).actions((function(e){return{toggleAddGameFormOpen:function(){e.isAddGameFormOpen=!e.isAddGameFormOpen},toggleAddThemeFormOpen:function(){e.isAddThemeFormOpen=!e.isAddThemeFormOpen},toggleAddQuestionFormOpen:function(){e.isAddQuestionFormOpen=!e.isAddQuestionFormOpen},toggleAddFinalQuestionFormOpen:function(){e.isAddFinalQuestionFormOpen=!e.isAddFinalQuestionFormOpen},clear:function(){e.isAddGameFormOpen=!0,e.isAddThemeFormOpen=!1,e.isAddQuestionFormOpen=!1,e.isAddFinalQuestionFormOpen=!1}}})),ee=U.b.model({nickname:U.b.identifier,score:U.b.integer,isPlaying:U.b.boolean,answer:U.b.maybe(U.b.string)}).actions((function(e){return{setIsPlaying:function(t){e.isPlaying=t}}})),te=U.b.model({text:"",isCorrect:!1}),ne=U.b.model({id:U.b.identifier,value:U.b.integer,text:U.b.maybe(U.b.string),isAnswered:U.b.boolean}).actions((function(e){return{setText:function(t){e.text=t}}})),re=U.b.model({theme:U.b.number,question:U.b.number}),se=U.b.model({name:U.b.string,questions:U.b.array(ne)}),ae=U.b.model({order:U.b.integer,themes:U.b.array(se)}),ie=U.b.model({id:U.b.maybe(U.b.number),state:U.b.optional(U.b.enumeration("state",Object.values(M)),M.WAITING),players:U.b.array(ee),currentPlayer:U.b.maybe(U.b.reference(ee)),currentRound:U.b.maybe(ae),currentQuestion:U.b.maybe(U.b.safeReference(ne)),currentQuestionIndexes:U.b.optional(re,{theme:-1,question:-1}),finalQuestion:U.b.maybe(ne),currentAnswer:U.b.maybe(te),roundText:""}).actions((function(e){return{listener:function(t,n){switch(t){case"player_joined":var r=e.players.find((function(e){return e.nickname===n.nickname}));r?r.setIsPlaying(!0):e.players.push({nickname:n.nickname,score:n.score,isPlaying:n.is_playing});break;case"player_left":var s=e.players.findIndex((function(e){return e.nickname===n.nickname}));e.state===M.WAITING?e.players.splice(s,1):e.players[s].isPlaying=!1;break;case"current_player_chosen":e.setCurrentPlayer(n);break;case"round_started":console.log(n),e.setCurrentRound(n),e.roundText=J(e.currentRound.order+1)+" \u0440\u0430\u0443\u043d\u0434",e.state=e.currentRound.order>0?M.ROUND_ENDED:M.ROUND_STARTED;break;case"current_question_chosen":e.setCurrentQuestion(n),e.state=M.ANSWERING;break;case"player_answered":e.currentAnswer=te.create({text:n.text,isCorrect:n.is_correct});var a=e.players.find((function(e){return e.nickname===n.player.nickname}));e.currentPlayer=a,a.score=n.player.score,e.currentAnswer.isCorrect&&(e.currentRound.themes[e.currentQuestionIndexes.theme].questions[e.currentQuestionIndexes.question].isAnswered=!0,1!==e.notAnsweredQuestionsCount&&(e.state=M.CHOOSING_QUESTION));break;case"question_timeout":e.currentQuestion.isAnswered=!0,e.currentAnswer=te.create({text:n.text,isCorrect:!0}),e.state=M.TIMEOUT;break;case"final_round_started":e.finalQuestion=ne.create({id:"final",value:n.value,text:n.text,isAnswered:!1}),e.currentQuestion=e.finalQuestion,e.state=M.FINAL_ROUND_STARTED;break;case"final_round_timeout":e.players.forEach((function(e){var t,r=n.players.find((function(t){return t.nickname===e.nickname}));e.score=r.score,e.answer=null!==(t=r.answer)&&void 0!==t?t:void 0})),e.state=M.END_GAME;break;default:throw new Error("\u043d\u0435\u0442 \u0442\u0430\u043a\u043e\u0433\u043e \u0441\u043e\u0431\u044b\u0442\u0438\u044f")}},initializeCreated:function(t){e.id=Number(t.id),e.players.push({nickname:t.players[0].nickname,score:t.players[0].score,isPlaying:t.players[0].is_playing})},initializeJoined:function(t){e.state=t.state,t.players.forEach((function(t){return e.players.push({nickname:t.nickname,score:t.score,isPlaying:t.is_playing})})),e.setCurrentRound(t.current_round),e.setCurrentPlayer(t.current_player),e.setCurrentQuestion(t.current_question)},setState:function(t){e.state=t},setId:function(t){e.id=t},setCurrentRound:function(t){e.currentRound=ae.create({order:t.order,themes:t.themes.map((function(e){return se.create({name:e.name,questions:e.questions.map((function(t){return ne.create({id:e.name+t.value,value:t.value,isAnswered:t.is_answered})}))})}))})},setCurrentPlayer:function(t){e.currentPlayer=e.players.find((function(e){return e.nickname===t.nickname}))},setCurrentQuestion:function(t){t&&(e.currentQuestion=e.currentRound.themes[t.theme_order].questions[t.question_order],e.currentQuestion.setText(t.text),e.currentQuestionIndexes.theme=t.theme_order,e.currentQuestionIndexes.question=t.question_order)},clearCurrentAnswer:function(){e.currentAnswer=void 0}}})).views((function(e){return{get notAnsweredQuestionsCount(){var t=0;return e.currentRound.themes.forEach((function(e){e.questions.forEach((function(e){e.isAnswered||t++}))})),t}}})),ce=U.b.model({gameSessionDescriptionStore:L,gameListStore:W,gameListViewStore:z,addGameStore:Z,addGameViewStore:$,gameSessionStore:ie}).create({gameSessionDescriptionStore:L.create(),gameListStore:W.create(),gameListViewStore:z.create(),addGameStore:Z.create(),addGameViewStore:$.create(),gameSessionStore:ie.create()}),oe=Object(s.createContext)(ce),ue=(oe.Provider,function(){return Object(s.useContext)(oe)}),de=new y,le=new N,me=Object(Q.a)((function(e){var t=e.history,n=ue(),s=n.gameListStore,a=n.gameListViewStore,i=n.gameSessionStore;return Object(r.jsx)(o.c,{initialValues:{maxPlayers:"2"},validationSchema:u.b({maxPlayers:u.a().required("\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435").min(2,"\u041d\u0435 \u043c\u0435\u043d\u0435\u0435 2 \u0438\u0433\u0440\u043e\u043a\u043e\u0432").max(10,"\u041d\u0435 \u0431\u043e\u043b\u0435\u0435 10 \u0438\u0433\u0440\u043e\u043a\u043e\u0432")}),onSubmit:function(e,n){var r=n.setSubmitting;le.create(s.chosenGame.name,e.maxPlayers).then((function(e){i.initializeCreated(e.data),localStorage.setItem("gameSessionId",e.data.id),r(!1),a.toggleCreateGameSessionFormOpen(),t.push("/game")}))},children:Object(r.jsxs)(o.b,{children:[Object(r.jsx)("header",{children:"\u041d\u043e\u0432\u0430\u044f \u0438\u0433\u0440\u0430"}),Object(r.jsx)(b,{label:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0438\u0433\u0440\u043e\u043a\u043e\u0432",name:"maxPlayers",type:"text"}),Object(r.jsx)("button",{type:"submit",children:"\u041d\u0430\u0447\u0430\u0442\u044c \u0438\u0433\u0440\u0443"})]})})})),be=Object(Q.a)((function(e){var t=ue(),n=t.gameListStore,s=t.gameListViewStore;return Object(r.jsxs)("tr",{children:[Object(r.jsx)("td",{children:e.descr.author}),Object(r.jsx)("td",{children:e.descr.name}),Object(r.jsx)("td",{children:e.descr.roundsCount}),Object(r.jsx)("td",{children:Object(r.jsx)("button",{onClick:function(){s.toggleCreateGameSessionFormOpen(),n.setChosenGame(e.descr)},children:"\u0418\u0433\u0440\u0430\u0442\u044c"})})]})})),je=Object(Q.a)((function(){var e=Object(O.g)(),t=ue(),n=t.gameListStore,a=t.gameListViewStore;return Object(s.useEffect)((function(){document.title="\u0418\u0433\u0440\u044b",de.getDescriptions().then((function(e){n.set(e.data)}))}),[n]),Object(r.jsxs)("div",{className:"games",children:[Object(r.jsx)("header",{children:"\u0418\u0433\u0440\u044b"}),Object(r.jsxs)("table",{className:"list games-table",children:[Object(r.jsx)("thead",{children:Object(r.jsxs)("tr",{children:[Object(r.jsx)("th",{children:"\u0410\u0432\u0442\u043e\u0440"}),Object(r.jsx)("th",{children:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"}),Object(r.jsx)("th",{children:"\u0420\u0430\u0443\u043d\u0434\u044b"})]})},"games-table-head"),Object(r.jsx)("tbody",{children:Object(G.z)(n.descriptions).map((function(e){return Object(r.jsx)(be,{descr:e},e.id)}))})]}),Object(r.jsx)("button",{onClick:function(){return e.push("/games/new")},children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u0438\u0433\u0440\u0443"}),Object(r.jsx)(q.a,{className:"modal form create-game-session",overlayClassName:"overlay",isOpen:a.isCreateGameSessionFormOpen,onRequestClose:a.toggleCreateGameSessionFormOpen,ariaHideApp:!1,children:Object(r.jsx)(me,{history:e})})]})}));n(242);var Oe=function(){var e=E().getUsername();return Object(r.jsxs)("header",{className:"nav",children:[Object(r.jsxs)("nav",{children:[Object(r.jsx)(I.c,{to:"/games",activeClassName:"active",children:"\u0418\u0433\u0440\u044b"}),Object(r.jsx)(I.c,{to:"/lobby",activeClassName:"active",children:"\u041b\u043e\u0431\u0431\u0438"})]}),Object(r.jsx)(I.b,{to:"/user",children:e})]})},he=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Object(h.a)(this,e),this.url=e.createUrl(t,n),this.listener=null,this.ws=new WebSocket(this.url)}return Object(f.a)(e,[{key:"setListener",value:function(e){var t=this;this.listener=e,this.ws.onmessage=function(e){var n=JSON.parse(e.data);console.log("ws",n),t.listener(n.event,n.data)}}},{key:"close",value:function(){console.log("ws close"),this.ws.close()}}],[{key:"createUrl",value:function(e,t){switch(e){case"lobby":return"ws://127.0.0.1:8000/ws/lobby/";case"game":return"ws://127.0.0.1:8000/ws/game_sessions/".concat(t,"/");default:throw new Error("\u043d\u0435\u0442 \u0442\u0430\u043a\u043e\u0433\u043e \u0442\u0438\u043f\u0430 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0439")}}}]),e}(),fe=new N,xe=Object(Q.a)((function(e){var t=e.descr,n=e.history,s=ue().gameSessionStore;return Object(r.jsxs)("tr",{children:[Object(r.jsx)("td",{children:t.creator}),Object(r.jsx)("td",{children:t.gameName}),Object(r.jsxs)("td",{children:[t.currentPlayers,"/",t.maxPlayers]}),Object(r.jsx)("td",{children:Object(r.jsx)("button",{onClick:function(){fe.join(t.id).then((function(e){return s.initializeJoined(e.data)})),localStorage.setItem("gameSessionId",t.id),n.push("/game")},children:"\u0418\u0433\u0440\u0430\u0442\u044c"})})]})})),ge=Object(Q.a)((function(){var e=Object(O.g)(),t=ue().gameSessionDescriptionStore;return Object(s.useEffect)((function(){document.title="\u041b\u043e\u0431\u0431\u0438";var e=new he("lobby");return e.setListener(t.listener),(new S).getDescriptions().then((function(e){t.initialize(e.data)})),function(){return e.close()}}),[t]),Object(r.jsxs)("div",{className:"lobby",children:[Object(r.jsx)("header",{children:"\u041b\u043e\u0431\u0431\u0438"}),Object(r.jsxs)("table",{className:"list lobby-table",children:[Object(r.jsx)("thead",{children:Object(r.jsxs)("tr",{children:[Object(r.jsx)("th",{children:"\u0421\u043e\u0437\u0434\u0430\u0442\u0435\u043b\u044c"}),Object(r.jsx)("th",{children:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"}),Object(r.jsx)("th",{children:"\u0418\u0433\u0440\u043e\u043a\u0438"})]})},"lobby-table-head"),Object(r.jsx)("tbody",{children:t.descriptions.size>0&&Object(G.z)(t.descriptions).map((function(t){return Object(r.jsx)(xe,{descr:t,history:e},t.creator)}))})]})]})})),pe=(n(100),new _),ve=Object(Q.a)((function(){var e=ue(),t=e.addGameStore,n=e.addGameViewStore;return Object(r.jsx)("div",{className:"form",children:Object(r.jsx)(o.c,{initialValues:{name:"",roundsCount:"3",questionsCount:"5"},validationSchema:u.b({name:u.c().required("\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435"),roundsCount:u.a().required("\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435").min(2,"\u041d\u0435 \u043c\u0435\u043d\u0435\u0435 2 \u0440\u0430\u0443\u043d\u0434\u043e\u0432").max(10,"\u041d\u0435 \u0431\u043e\u043b\u0435\u0435 10 \u0440\u0430\u0443\u043d\u0434\u043e\u0432").typeError("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0447\u0438\u0441\u043b\u043e").integer("\u0422\u0430\u043a \u0442\u043e\u0436\u0435 \u043d\u0435 \u043f\u0440\u043e\u043a\u0430\u0442\u0438\u0442"),questionsCount:u.a().required("\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435").min(1,"\u041d\u0435 \u043c\u0435\u043d\u0435\u0435 1 \u0432\u043e\u043f\u0440\u043e\u0441\u0430").max(10,"\u041d\u0435 \u0431\u043e\u043b\u0435\u0435 10 \u0432\u0435\u043f\u0440\u043e\u0441\u043e\u0432").typeError("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0447\u0438\u0441\u043b\u043e").integer("\u0422\u0430\u043a \u0442\u043e\u0436\u0435 \u043d\u0435 \u043f\u0440\u043e\u043a\u0430\u0442\u0438\u0442")}),onSubmit:function(e,r){(0,r.setSubmitting)(!1),t.setGameParams(e.name,Number(e.roundsCount),Number(e.questionsCount)),n.toggleAddGameFormOpen()},children:Object(r.jsxs)(o.b,{children:[Object(r.jsx)("header",{children:"\u041d\u043e\u0432\u0430\u044f \u0438\u0433\u0440\u0430"}),Object(r.jsx)(b,{label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",name:"name",type:"text"}),Object(r.jsx)(b,{label:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0440\u0430\u0443\u043d\u0434\u043e\u0432",name:"roundsCount",type:"text"}),Object(r.jsx)(b,{label:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0432\u043e\u043f\u0440\u043e\u0441\u043e\u0432 \u0432 \u0442\u0435\u043c\u0435",name:"questionsCount",type:"text"}),Object(r.jsx)("button",{type:"submit",children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0438\u0433\u0440\u0443"})]})})})})),ye=Object(Q.a)((function(){var e=ue(),t=e.addGameStore,n=e.addGameViewStore;return Object(r.jsx)(o.c,{initialValues:{name:""},validationSchema:u.b({name:u.c().required("\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435").max(20,"\u041d\u0435 \u0431\u043e\u043b\u0435\u0435 20 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432")}),onSubmit:function(e,r){(0,r.setSubmitting)(!1),n.toggleAddThemeFormOpen(),t.selectedRound.addTheme(e.name)},children:Object(r.jsxs)(o.b,{children:[Object(r.jsx)("header",{children:"\u041d\u043e\u0432\u0430\u044f \u0442\u0435\u043c\u0430"}),Object(r.jsx)(b,{label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",name:"name",type:"text"}),Object(r.jsx)("button",{type:"submit",children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0442\u0435\u043c\u0443"})]})})})),Se=Object(Q.a)((function(e){var t=e.question,n=ue(),s=n.addGameStore,a=n.addGameViewStore;return Object(r.jsx)("td",{className:"question-cell ".concat(t.isSet?"":"empty"),onClick:function(){s.setSelectedQuestion(t),a.toggleAddQuestionFormOpen()},children:t.value})})),_e=function(e){var t=e.theme;return Object(r.jsxs)("tr",{children:[Object(r.jsx)("td",{className:"theme-name",children:t.name},t.name),t.questions.map((function(e){return Object(r.jsx)(Se,{question:e},t.name+e.value.toString())}))]})},we=Object(Q.a)((function(){var e,t,n=ue(),s=n.addGameStore,a=n.addGameViewStore;return Object(r.jsx)(o.c,{initialValues:{text:null!==(e=s.selectedQuestion.text)&&void 0!==e?e:"",answer:null!==(t=s.selectedQuestion.answer)&&void 0!==t?t:""},validationSchema:u.b({text:u.c().required("\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435").max(200,"\u041d\u0435 \u0431\u043e\u043b\u0435\u0435 200 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"),answer:u.c().required("\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435").max(50,"\u041d\u0435 \u0431\u043e\u043b\u0435\u0435 50 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432")}),onSubmit:function(e,t){(0,t.setSubmitting)(!1),a.toggleAddQuestionFormOpen(),s.selectedQuestion.set(e.text,e.answer)},children:Object(r.jsxs)(o.b,{children:[Object(r.jsxs)("header",{children:["\u0412\u043e\u043f\u0440\u043e\u0441 \u0437\u0430 ",s.selectedQuestion.value]}),Object(r.jsx)(b,{label:"\u0422\u0435\u043a\u0441\u0442 \u0432\u043e\u043f\u0440\u043e\u0441\u0430",name:"text",type:"text"}),Object(r.jsx)(b,{label:"\u041e\u0442\u0432\u0435\u0442",name:"answer",type:"text"}),Object(r.jsx)("button",{type:"submit",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})})})),Ne=Object(Q.a)((function(e){var t,n,s=e.history,a=ue().addGameStore;return Object(r.jsx)(o.c,{initialValues:{text:null!==(t=a.finalRound.text)&&void 0!==t?t:"",answer:null!==(n=a.finalRound.answer)&&void 0!==n?n:""},validationSchema:u.b({text:u.c().required("\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435").max(200,"\u041d\u0435 \u0431\u043e\u043b\u0435\u0435 200 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"),answer:u.c().required("\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435").max(50,"\u041d\u0435 \u0431\u043e\u043b\u0435\u0435 50 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432")}),onSubmit:function(e,t){var n=t.setSubmitting,r=t.setErrors;if(a.setFinalRound(e.text,e.answer),a.isAllRoundsFilled)if(a.isAllQuestionsFilled){var i=Object(U.a)(a);pe.post({name:i.name,rounds:i.rounds.map((function(e){return{themes:e.themes.map((function(e){return{name:e.name,questions:e.questions.map((function(e){e.id;return Object(m.a)(e,["id"])}))}}))}})),finalRound:{value:i.finalRound.value,text:i.finalRound.text,answer:i.finalRound.answer}}).then((function(){n(!1),s.push("/games")})).catch((function(e){return r({submitError:e.message})}))}else r({submitError:"\u0417\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0432\u0441\u0435 \u0432\u043e\u043f\u0440\u043e\u0441\u044b"});else r({submitError:"\u0412 \u043a\u0430\u0436\u0434\u043e\u043c \u0440\u0430\u0443\u043d\u0434\u0435 \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u0442\u0435\u043c\u044b"})},children:Object(r.jsxs)(o.b,{children:[Object(r.jsx)("header",{children:"\u0424\u0438\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u0432\u043e\u043f\u0440\u043e\u0441"}),Object(r.jsx)(b,{label:"\u0422\u0435\u043a\u0441\u0442 \u0432\u043e\u043f\u0440\u043e\u0441\u0430",name:"text",type:"text"}),Object(r.jsx)(b,{label:"\u041e\u0442\u0432\u0435\u0442",name:"answer",type:"text"}),Object(r.jsx)(j,{name:"submitError"}),Object(r.jsx)("button",{type:"submit",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0438\u0433\u0440\u0443"})]})})})),Ae=Object(Q.a)((function(e){var t=e.round,n=ue(),s=n.addGameStore,a=n.addGameViewStore;return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)("header",{children:[J(t.index+1)," \u0440\u0430\u0443\u043d\u0434"]}),Object(r.jsx)("table",{className:"round add-game-table",children:Object(r.jsx)("tbody",{children:t.themes&&t.themes.map((function(e){return Object(r.jsx)(_e,{theme:e},e.name)}))})}),Object(r.jsx)("div",{className:"button-group",children:Object(r.jsx)("button",{onClick:a.toggleAddThemeFormOpen,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0442\u0435\u043c\u0443"})}),Object(r.jsxs)("div",{className:"button-group",children:[Object(r.jsx)("button",{disabled:0===t.index,onClick:s.previousRound,children:"\u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0439 \u0440\u0430\u0443\u043d\u0434"}),Object(r.jsx)("button",{onClick:function(){t.index<s.roundsCount-2?s.nextRound():a.toggleAddFinalQuestionFormOpen()},children:"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u0440\u0430\u0443\u043d\u0434"})]})]})})),ke=Object(Q.a)((function(){var e=Object(O.g)(),t=ue(),n=t.addGameStore,s=t.addGameViewStore;return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Ae,{round:n.selectedRound}),Object(r.jsx)(q.a,{className:"modal form add-theme",overlayClassName:"overlay",isOpen:s.isAddThemeFormOpen,onRequestClose:s.toggleAddThemeFormOpen,ariaHideApp:!1,children:Object(r.jsx)(ye,{})}),Object(r.jsx)(q.a,{className:"modal form add-question",overlayClassName:"overlay",isOpen:s.isAddQuestionFormOpen,onRequestClose:s.toggleAddQuestionFormOpen,ariaHideApp:!1,children:Object(r.jsx)(we,{})}),Object(r.jsx)(q.a,{className:"modal form add-final-question",overlayClassName:"overlay",isOpen:s.isAddFinalQuestionFormOpen,onRequestClose:s.toggleAddFinalQuestionFormOpen,ariaHideApp:!1,children:Object(r.jsx)(Ne,{history:e})})]})})),Ee=Object(Q.a)((function(){var e=ue(),t=e.addGameStore,n=e.addGameViewStore;return Object(s.useEffect)((function(){return document.title="\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0438\u0433\u0440\u044b",function(){t.clear(),n.clear()}}),[t,n]),Object(r.jsx)("div",{className:"add-game",children:n.isAddGameFormOpen?Object(r.jsx)(ve,{}):Object(r.jsx)(ke,{})})})),Re=new w,Ce=function(){var e=E(),t=Object(s.useState)({nickname:"",password:""}),n=Object(l.a)(t,2),a=n[0],i=n[1];return document.title="\u041f\u0440\u043e\u0444\u0438\u043b\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",Object(s.useEffect)((function(){Re.get(e.getUsername()).then((function(e){return i({username:e.data.username,nickname:e.data.nickname,password:""})}))}),[e]),Object(r.jsx)("div",{className:"form",children:Object(r.jsx)(o.c,{enableReinitialize:!0,initialValues:a,validationSchema:u.b({nickname:u.c().optional().min(2,"\u041d\u0435 \u043c\u0435\u043d\u0435\u0435 2 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432").max(25,"\u041d\u0435 \u0431\u043e\u043b\u0435\u0435 25 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"),password:u.c().optional().min(6,"\u041d\u0435 \u043c\u0435\u043d\u0435\u0435 6 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432").max(128,"\u041d\u0435 \u0431\u043e\u043b\u0435\u0435 128 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432")}),onSubmit:function(e,t){var n=t.setSubmitting,r=t.setErrors;0===e.nickname.length&&0===e.password.length?r({submitError:"\u0417\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0445\u043e\u0442\u044f \u0431\u044b \u043e\u0434\u043d\u043e \u043f\u043e\u043b\u0435"}):Re.save(a.username,e.nickname,e.password).then((function(){return n(!1)}))},children:Object(r.jsxs)(o.b,{children:[Object(r.jsx)("header",{children:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c"}),Object(r.jsx)(b,{label:"\u041d\u0438\u043a",name:"nickname",type:"text"}),Object(r.jsx)(b,{label:"\u041f\u0430\u0440\u043e\u043b\u044c",name:"password",type:"password"}),Object(r.jsx)(j,{name:"submitError"}),Object(r.jsx)("button",{type:"submit",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})})})},Ie=(n(243),n(41)),Fe=new N,Te=Object(Q.a)((function(){var e=ue().gameSessionStore,t=Object(O.g)();return Object(r.jsxs)("div",{className:"player-controls",children:[Object(r.jsx)(o.c,{initialValues:{answer:""},onSubmit:function(t,n){var r,s=n.setSubmitting,a=n.resetForm;(null===(r=t.answer)||void 0===r?void 0:r.length)>0&&(Fe.submit_answer(e.id,t.answer),a(),s(!1))},children:Object(r.jsxs)(o.b,{children:[Object(r.jsx)(o.a,{id:"answer",as:"textarea",name:"answer",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043e\u0442\u0432\u0435\u0442"}),Object(r.jsx)("button",{type:"submit",children:"\u041e\u0442\u0432\u0435\u0442\u0438\u0442\u044c"})]})}),Object(r.jsx)("button",{onClick:function(){Fe.leave(e.id),t.push("/games")},children:"\u0412\u044b\u0439\u0442\u0438 \u0438\u0437 \u0438\u0433\u0440\u044b"})]})})),De=Object(Q.a)((function(){var e,t=ue().gameSessionStore,n="";switch(t.state){case M.WAITING:n="\u043e\u0436\u0438\u0434\u0430\u0435\u043c \u0438\u0433\u0440\u043e\u043a\u043e\u0432",e=Fe.get_host_image_url(M.WAITING);break;case M.ROUND_ENDED:case M.FINAL_ROUND_STARTED:case M.CHOOSING_QUESTION:case M.TIMEOUT:var s;t.state===M.TIMEOUT?n="\u041f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u043e\u0442\u0432\u0435\u0442: ".concat(t.currentAnswer.text,". "):(null===(s=t.currentAnswer)||void 0===s?void 0:s.isCorrect)&&(n="\u041f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u043e! "),t.state===M.ROUND_ENDED?(n+="\u0420\u0430\u0443\u043d\u0434 \u0437\u0430\u043a\u043e\u043d\u0447\u0435\u043d.",e=Fe.get_host_image_url(M.ROUND_STARTED)):t.state===M.FINAL_ROUND_STARTED?(n+="\u0412\u043f\u0435\u0440\u0435\u0434\u0438 \u0444\u0438\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u0440\u0430\u0443\u043d\u0434.",e=Fe.get_host_image_url(M.ROUND_STARTED)):(n+="".concat(t.currentPlayer.nickname,", \u0432\u044b\u0431\u0438\u0440\u0430\u0439\u0442\u0435 \u0432\u043e\u043f\u0440\u043e\u0441."),e=Fe.get_host_image_url(M.CHOOSING_QUESTION));break;case M.ANSWERING:var a,i=t.currentRound.themes[t.currentQuestionIndexes.theme].name,c=t.currentQuestion.value;n="".concat(i," \u0437\u0430 ").concat(c),e=Fe.get_host_image_url(M.ANSWERING),(null===(a=t.currentAnswer)||void 0===a?void 0:a.text.length)>0&&(n="\u041d\u0435\u0432\u0435\u0440\u043d\u043e.",e=Fe.get_host_image_url("wrong"));break;case M.FINAL_ROUND:e=Fe.get_host_image_url(M.FINAL_ROUND),n="\u0424\u0438\u043d\u0430\u043b\u044c\u043d\u044b\u0439 \u0440\u0430\u0443\u043d\u0434";break;case M.END_GAME:var o=t.players.reduce((function(e,t){return e.score>t.score?e:t}));n="\u041f\u043e\u0431\u0435\u0434\u0438\u043b ".concat(o.nickname,"!"),e=Fe.get_host_image_url(M.END_GAME);break;default:n="",e=Fe.get_host_image_url(M.WAITING)}return Object(r.jsxs)("div",{className:"host-card",children:[Object(r.jsx)("img",{src:e,alt:"host"}),Object(r.jsx)("div",{children:n})]})})),qe=Object(Q.a)((function(){var e=ue().gameSessionStore;return Object(r.jsx)("div",{className:"question",children:[M.ROUND_STARTED,M.ROUND_ENDED,M.FINAL_ROUND_STARTED,M.WAITING].includes(e.state)?e.roundText:e.currentQuestion.text})})),Ge=Object(Q.a)((function(e){var t=e.question,n=e.theme_order,a=e.question_order,i=ue().gameSessionStore,c=Object(s.useState)(!1),o=Object(l.a)(c,2),u=o[0],d=o[1];return Object(r.jsx)("td",{className:"question-cell ".concat(t.isAnswered?"empty":""," ").concat(u?"clicked":""),onClick:function(){d(!0),Fe.choose_question(i.id,n,a)},children:t.value})})),Qe=function(e){var t=e.theme,n=e.theme_order;return Object(r.jsxs)("tr",{children:[Object(r.jsx)("td",{children:t.name}),t.questions.map((function(e,t){return Object(r.jsx)(Ge,{theme_order:n,question:e,question_order:t},e.value)}))]})},Ue=function(e){var t=e.themes;return Object(r.jsx)("table",{className:"round round-table",children:Object(r.jsx)("tbody",{children:t.map((function(e,t){return Object(r.jsx)(Qe,{theme:e,theme_order:t},e.name)}))})})},Pe=Object(Q.a)((function(){var e=ue().gameSessionStore;return[M.CHOOSING_QUESTION,M.TIMEOUT].includes(e.state)?Object(r.jsx)(Ue,{themes:e.currentRound.themes},"table"):Object(r.jsx)(qe,{},"question")})),Le=Object(Q.a)((function(e){var t,n=e.player,a=ue().gameSessionStore,i=Object(s.useState)(""),c=Object(l.a)(i,2),o=c[0],u=c[1];function d(){setTimeout(Ie.a.hide,3e3,t)}return Object(s.useEffect)((function(){var e,r;(null===(e=a.currentAnswer)||void 0===e?void 0:e.text.length)>0&&(null===(r=a.currentPlayer)||void 0===r?void 0:r.nickname)===n.nickname&&(u(a.currentAnswer.text),Ie.a.show(t),d())}),[a.currentAnswer]),Object(s.useEffect)((function(){n.answer&&(u(n.answer),Ie.a.show(t),d())}),[n.answer]),Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)("div",{className:"player-card","data-tip":!0,"data-for":n.nickname+"_tooltip",ref:function(e){return t=e},children:[Object(r.jsx)("img",{src:Fe.get_avatar_url(),alt:n.nickname}),Object(r.jsx)("div",{children:n.nickname}),Object(r.jsx)("div",{children:n.score})]}),Object(r.jsx)(Ie.a,{className:"tooltip",id:n.nickname+"_tooltip",effect:"solid",delayHide:3e3,event:"null",getContent:function(){return o}})]})})),Ve=Object(Q.a)((function(){var e=ue().gameSessionStore;return Object(r.jsx)("div",{className:"players",children:e.players.map((function(e){return Object(r.jsx)(Le,{player:e},e.nickname)}))})})),We=Object(Q.a)((function(){var e=ue().gameSessionStore;return Object(s.useEffect)((function(){document.title="\u0418\u0433\u0440\u0430";var t=e.id>0?e.id:Number(localStorage.getItem("gameSessionId"));e.id||e.setId(t);var n=new he("game",t);return n.setListener(e.listener),function(){return n.close()}}),[e]),Object(s.useEffect)((function(){function t(t){setTimeout(e.setState,5e3,t)}e.state===M.ROUND_ENDED?t(M.ROUND_STARTED):e.state===M.ROUND_STARTED?(e.clearCurrentAnswer(),t(M.CHOOSING_QUESTION)):e.state===M.FINAL_ROUND_STARTED&&t(M.FINAL_ROUND)}),[e,e.state]),Object(r.jsxs)("div",{className:"game",children:[Object(r.jsx)(Pe,{}),Object(r.jsx)(Ve,{}),Object(r.jsx)(De,{}),Object(r.jsx)(Te,{})]})}));var ze=function(){var e=E();return Object(r.jsx)(I.a,{children:Object(r.jsxs)(O.d,{children:[Object(r.jsx)(O.b,{exact:!0,path:"/",children:e.isAuthenticated?Object(r.jsx)(O.a,{to:"/games"}):Object(r.jsx)(O.a,{to:"/login"})}),Object(r.jsx)(O.b,{path:"/register",children:Object(r.jsx)(F,{})}),Object(r.jsx)(O.b,{path:"/login",children:Object(r.jsx)(T,{})}),Object(r.jsxs)(s.Fragment,{children:[Object(r.jsx)(Oe,{}),Object(r.jsx)(C,{exact:!0,path:"/user",children:Object(r.jsx)(Ce,{})}),Object(r.jsx)(C,{exact:!0,path:"/games",children:Object(r.jsx)(je,{})}),Object(r.jsx)(C,{exact:!0,path:"/games/new",children:Object(r.jsx)(Ee,{})}),Object(r.jsx)(C,{path:"/lobby",children:Object(r.jsx)(ge,{})}),Object(r.jsx)(C,{path:"/game",children:Object(r.jsx)(We,{})})]})]})})},He=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,246)).then((function(t){var n=t.getCLS,r=t.getFID,s=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),r(e),s(e),a(e),i(e)}))};c.a.render(Object(r.jsx)(a.a.StrictMode,{children:Object(r.jsx)(R,{children:Object(r.jsx)(ze,{})})}),document.getElementById("root")),He()},96:function(e,t,n){}},[[244,1,2]]]);
//# sourceMappingURL=main.cebd4e1e.chunk.js.map